{"version":3,"sources":["assets\\Script\\MainScene\\MainSceneCtrl.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wCAAmC;AACnC,kDAA+C;AAC/C,4CAAiD;AACjD,sDAAiD;AAGjD,mDAA+D;AAEzD,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAwC,8BAAY;IAApD;QAAA,qEA2HC;QAxHG,cAAQ,GAAiB,IAAI,CAAC;QAI9B,gBAAU,GAAY,IAAI,CAAC;QAG3B,gBAAU,GAAgB,EAAE,CAAC;QAG7B,oBAAc,GAAmB,IAAI,CAAC;QAItC,WAAK,GAAa,IAAI,CAAC;QAGvB,WAAK,GAAa,IAAI,CAAC;QAGvB,qBAAe,GAAG,IAAI,CAAC;QAGvB,WAAK,GAAY,IAAI,CAAC;QAGtB,qBAAe,GAAuB,IAAI,CAAC;QAEnC,yBAAmB,GAAW,CAAC,CAAC;QAChC,yBAAmB,GAAY,KAAK,CAAC;QACrC,kBAAY,GAAc,EAAE,CAAC;QAC7B,mBAAa,GAA0B,IAAI,CAAC;;IAyFxD,CAAC;IAtFG,sBAAI,8BAAM;aAAV;YACI,OAAO,qBAAW,CAAC,IAAI,CAAC,OAAO,CAAc,mBAAW,CAAC,WAAW,CAAC,CAAC;QAC1E,CAAC;;;OAAA;IACS,2BAAM,GAAhB;QACI,oCAAoC;QAEpC,IAAI,UAAU,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACpD,UAAU,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;QAC1B,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACrC,IAAI,YAAY,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACtD,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QACvC,IAAI,cAAc,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACxD,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;QACzC,IAAI,UAAU,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACpD,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACrC,IAAI,kBAAkB,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QAC5D,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;QAC7C,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC;QAE7C,IAAI,CAAC,YAAY,EAAE,CAAA;QACnB,IAAI,CAAC,aAAa,EAAE,CAAC;IACzB,CAAC;IACO,kCAAa,GAArB;QAAA,iBAaC;QAZG,IAAI,CAAC,aAAa,GAAG,IAAI,GAAG,EAAoB,CAAC;QACjD,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,iBAAM,CAAC,qBAAqB,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QACnF,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,iBAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QAC9E,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,iBAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAClF,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,iBAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAClF,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,iBAAM,CAAC,qBAAqB,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QAErF,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,KAAK;YACpC,gBAAM,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,KAAI,CAAC,EAAE,KAAI,CAAC,CAAC;QAClD,CAAC,CAAC,CAAC;QAEH,gBAAM,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAM,CAAC,wBAAwB,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;IAC3E,CAAC;IAEO,iCAAY,GAApB;QACI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC;QAC9C,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC;QAC9C,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,GAAG,EAAE,CAAC;IACtE,CAAC;IAIO,qCAAgB,GAAxB,UAAyB,IAAY,EAAE,KAAkB;QACrD,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM;YAAE,OAAO;QAC5C,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;IAC/C,CAAC;IAEO,mCAAc,GAAtB,UAAuB,KAAa;QAChC,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC;QAChD,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IACzD,CAAC;IAED,0BAAK,GAAL;IAEA,CAAC;IAED,+BAAU,GAAV,UAAW,KAAK,EAAE,eAAe;QAAjC,iBA0BC;QAzBG,IAAI,oBAAoB,GAAG,QAAQ,CAAC,eAAe,CAAC,CAAC;QACrD,IAAI,IAAI,CAAC,mBAAmB,KAAK,oBAAoB,IAAI,IAAI,CAAC,mBAAmB;YAAE,OAAO;QAG1F,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,oBAAoB,KAAK,CAAC,CAAC;QAE/C,MAAM;QACN,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;QAChC,IAAI,cAAc,GAAG,IAAI,CAAC,mBAAmB,GAAG,oBAAoB,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;QAC1G,IAAI,QAAQ,GAAG,GAAG,CAAC;QACnB,IAAI,QAAQ,GAAG,IAAI,CAAC,mBAAmB,CAAC;QAExC,yDAAyD;QACzD,IAAI,CAAC,YAAY,CAAC,oBAAoB,CAAC,CAAC,CAAC,GAAG,cAAc,CAAC;QAC3D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC;YAC1H,KAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;YACjC,8CAA8C;QAElD,CAAC,CAAC,CAAC,CAAC,CAAC;QACL,IAAI,CAAC,YAAY,CAAC,oBAAoB,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC;QAC5G,CAAC,CAAC,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,mBAAmB,GAAG,oBAAoB,CAAC;IAGpD,CAAC;IAvHD;QADC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;gDACO;IAI9B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;kDACS;IAG3B;QADC,QAAQ,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;kDACO;IAG7B;QADC,QAAQ,CAAC,wBAAc,CAAC;sDACa;IAItC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6CACI;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6CACI;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;uDACI;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;6CACI;IAGtB;QADC,QAAQ,CAAC,EAAE,CAAC,eAAe,CAAC;uDACc;IA7B1B,UAAU;QAD9B,OAAO;OACa,UAAU,CA2H9B;IAAD,iBAAC;CA3HD,AA2HC,CA3HuC,EAAE,CAAC,SAAS,GA2HnD;kBA3HoB,UAAU","file":"","sourceRoot":"/","sourcesContent":["import Global from \"../App/Global\";\r\nimport { LocMsg } from \"../BaseModel/MsgEvent\";\r\nimport { DataBaseKey } from \"../BaseModel/Types\";\r\nimport DataManager from \"../Manager/DataManager\";\r\nimport { IPlayerInfo } from \"../Model/PlayerProp\";\r\nimport { IRobot } from \"../Model/RobotProp\";\r\nimport RobotInforCtrl, { INFOR_STATE } from \"./RobotInforCtrl\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Helloworld extends cc.Component {\r\n\r\n    @property(cc.Animation)\r\n    menuAnim: cc.Animation = null;\r\n\r\n\r\n    @property(cc.Node)\r\n    centerRoot: cc.Node = null;\r\n\r\n    @property([cc.Prefab])\r\n    centerPref: cc.Prefab[] = [];\r\n\r\n    @property(RobotInforCtrl)\r\n    robotInforCtrl: RobotInforCtrl = null;\r\n\r\n\r\n    @property(cc.Label)\r\n    lbHal: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lbAce: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lbCollectEnergy = null;\r\n\r\n    @property(cc.Node)\r\n    ndTop: cc.Node = null;\r\n\r\n    @property(cc.ToggleContainer)\r\n    toggleContainer: cc.ToggleContainer = null;\r\n\r\n    private curCenterGroupIndex: number = 0;\r\n    private centerGroupIsMoving: boolean = false;\r\n    private centerGroups: cc.Node[] = [];\r\n    private _mapEventBind: Map<string, Function> = null;\r\n\r\n\r\n    get player() {\r\n        return DataManager.Inst.GetData<IPlayerInfo>(DataBaseKey.PLAYER_DATA);\r\n    }\r\n    protected onLoad(): void {\r\n        // this.menuAnim.play('menu_reset');\r\n\r\n        let homeCenter = cc.instantiate(this.centerPref[0]);\r\n        homeCenter.position.x = 0;\r\n        this.centerRoot.addChild(homeCenter);\r\n        let friendCenter = cc.instantiate(this.centerPref[1]);\r\n        this.centerRoot.addChild(friendCenter);\r\n        let backpackCenter = cc.instantiate(this.centerPref[2]);\r\n        this.centerRoot.addChild(backpackCenter);\r\n        let shopCenter = cc.instantiate(this.centerPref[3]);\r\n        this.centerRoot.addChild(shopCenter);\r\n        let friendEnergyCenter = cc.instantiate(this.centerPref[4]);\r\n        this.centerRoot.addChild(friendEnergyCenter);\r\n        this.centerGroups = this.centerRoot.children;\r\n\r\n        this._UpdateTopUI()\r\n        this._InitListener();\r\n    }\r\n    private _InitListener() {\r\n        this._mapEventBind = new Map<string, Function>();\r\n        this._mapEventBind.set(LocMsg.UPDATE_COLLECT_ENERGY.toString(), this._UpdateTopUI);\r\n        this._mapEventBind.set(LocMsg.UPDATE_HAL_COUNT.toString(), this._UpdateTopUI);\r\n        this._mapEventBind.set(LocMsg.SHOW_ROBOT_INFOR.toString(), this._ShowRobotDialog);\r\n        this._mapEventBind.set(LocMsg.SHOW_ROBOT_INFOR.toString(), this._ShowRobotDialog);\r\n        this._mapEventBind.set(LocMsg.CHANGE_GROUP_BY_INDEX.toString(), this._ShowShopGroup);\r\n\r\n        this._mapEventBind.forEach((value, event) => {\r\n            Global.Inst.On(event, value.bind(this), this);\r\n        });\r\n\r\n        Global.Inst.On(LocMsg.SHOW_FRIEND_Energy_INFOR, this.OnBtnClick, this);\r\n    }\r\n\r\n    private _UpdateTopUI() {\r\n        this.lbHal.string = this.player.halCount + \"\";\r\n        this.lbAce.string = this.player.aceCount + \"\";\r\n        this.lbCollectEnergy.string = this.player.collectEnergyCount + \"\";\r\n    }\r\n\r\n\r\n\r\n    private _ShowRobotDialog(data: IRobot, state: INFOR_STATE) {\r\n        if (this.robotInforCtrl.node.active) return;\r\n        this.robotInforCtrl.setDialog(data, state);\r\n    }\r\n\r\n    private _ShowShopGroup(index: number) {\r\n        this.toggleContainer.toggleItems[index].check();\r\n        this.OnBtnClick(null, index > 2 ? index - 1 : index);\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    OnBtnClick(event, customEventData) {\r\n        let lastCenterGroupIndex = parseInt(customEventData);\r\n        if (this.curCenterGroupIndex === lastCenterGroupIndex || this.centerGroupIsMoving) return;\r\n\r\n\r\n        this.ndTop.active = lastCenterGroupIndex !== 1;\r\n\r\n        //左滑动；\r\n        this.centerGroupIsMoving = true;\r\n        let lastCenterPosX = this.curCenterGroupIndex < lastCenterGroupIndex ? this.node.width : -this.node.width;\r\n        let moveTime = 0.1;\r\n        let oldIndex = this.curCenterGroupIndex;\r\n\r\n        // this.centerGroups[lastCenterGroupIndex].active = true;\r\n        this.centerGroups[lastCenterGroupIndex].x = lastCenterPosX;\r\n        this.centerGroups[this.curCenterGroupIndex].runAction(cc.sequence(cc.moveTo(moveTime, cc.v2(-lastCenterPosX, 0)), cc.callFunc(() => {\r\n            this.centerGroupIsMoving = false;\r\n            // this.centerGroups[oldIndex].active = false;\r\n\r\n        })));\r\n        this.centerGroups[lastCenterGroupIndex].runAction(cc.sequence(cc.moveTo(moveTime, cc.v2(0, 0)), cc.callFunc(() => {\r\n        })));\r\n\r\n        this.curCenterGroupIndex = lastCenterGroupIndex;\r\n\r\n\r\n    }\r\n}\r\n"]}